<div class="min-h-screen bg-gray-100 p-6 flex flex-col lg:flex-row gap-6">
  <!-- Columna principal: Reseñas Recientes -->
  <div class="flex-1">
    <h2 class="text-3xl font-bold text-gray-800 mb-4">Reseñas Recientes</h2>

    <div
      *ngIf="summary?.recentReviews?.length; else noReviews"
      class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"
    >
      <div
        *ngFor="let review of summary?.recentReviews"
        class="bg-white rounded-2xl shadow p-4 border border-gray-100"
      >
        <div class="flex items-start gap-3 mb-3">
          <!-- Avatar dinámico por nombre y color según calificación -->
          <p-avatar
            [label]="review.customerName[0]"
            shape="circle"
            [style]="{
              backgroundColor:
                review.rating >= 4
                  ? '#16a34a'
                  : review.rating === 3
                  ? '#facc15'
                  : '#ef4444',
              color: '#fff'
            }"
            size="large"
          ></p-avatar>

          <div class="flex-1">
            <p class="font-semibold text-gray-900">{{ review.customerName }}</p>
            <p class="text-gray-400 text-sm">{{ review.date | date }}</p>
            <div class="flex gap-1 mt-1 text-yellow-400">
              <ng-container *ngFor="let _ of [].constructor(review.rating)"
                >★</ng-container
              >
            </div>
          </div>
        </div>

        <p class="text-gray-700 text-sm mb-2">{{ review.comment }}</p>
      </div>
    </div>

    <ng-template #noReviews>
      <div
        class="text-center text-gray-500 italic bg-white p-6 rounded-xl shadow"
      >
        No hay reseñas recientes todavía.
      </div>
    </ng-template>
  </div>

  <!-- Columna lateral: Programa de Lealtad -->
  <div class="w-full lg:w-80 flex flex-col gap-6 mt-6 lg:mt-0">
    <!-- Estadísticas -->
    <div class="bg-white rounded-2xl shadow p-4 border border-gray-100">
      <h3 class="font-semibold text-gray-900 text-lg mb-3">Estadísticas</h3>
      <div class="space-y-2 text-sm">
        <div class="flex justify-between">
          <span class="text-gray-600">Promedio de Satisfacción:</span>
          <span class="font-bold text-yellow-500"
            >{{ summary?.averageRating | number : "1.1-2" }} ★</span
          >
        </div>
        <div class="flex justify-between">
          <span class="text-gray-600">Clientes Registrados:</span>
          <span class="font-bold text-gray-800">{{
            summary?.totalRegisteredCustomers
          }}</span>
        </div>
        <div class="flex justify-between">
          <span class="text-gray-600">Puntos Acumulados:</span>
          <span class="font-bold text-green-600">{{
            summary?.totalPointsAccumulated
          }}</span>
        </div>
        <div class="flex justify-between">
          <span class="text-gray-600">Puntos Canjeados:</span>
          <span class="font-bold text-red-600">{{
            summary?.totalPointsRedeemed
          }}</span>
        </div>
      </div>
    </div>

    <!-- Clientes más leales -->
    <div class="bg-white rounded-2xl shadow p-4 border border-gray-100">
      <h3 class="font-semibold mb-4 text-gray-900 text-lg">
        Clientes Más Leales
      </h3>
      <ul
        *ngIf="summary?.topLoyalCustomers?.length; else noCustomers"
        class="space-y-3"
      >
        <li
          *ngFor="let c of summary?.topLoyalCustomers"
          class="flex items-center gap-3"
        >
          <p-avatar
            [label]="c.fullName[0]"
            shape="circle"
            [style]="{ 'background-color': '#ece9fc', color: '#2a1261' }"
          ></p-avatar>
          <div class="flex-1">
            <p class="font-medium text-gray-800">{{ c.fullName }}</p>
            <p class="text-xs text-gray-500">{{ c.email }}</p>
          </div>
          <span
            class="px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-semibold"
          >
            {{ c.points }} pts
          </span>
        </li>
      </ul>

      <ng-template #noCustomers>
        <p class="text-gray-500 text-sm italic">No hay clientes registrados.</p>
      </ng-template>
    </div>

    <!-- Premios disponibles -->
    <div class="bg-white rounded-2xl shadow p-4 border border-gray-100">
      <h3 class="font-semibold text-gray-900 text-lg mb-4">
        Premios Disponibles
      </h3>
      <div
        *ngIf="summary?.availableRewards?.length; else noRewards"
        class="space-y-3"
      >
        <div
          *ngFor="let reward of summary?.availableRewards"
          class="p-3 border rounded-xl bg-gray-50"
        >
          <p class="font-semibold text-gray-800">{{ reward.name }}</p>
          <p class="text-xs text-gray-500 mb-1">{{ reward.description }}</p>
          <div class="flex items-center justify-between">
            <span class="text-gray-600 text-sm">Requiere:</span>
            <span class="font-bold text-blue-600"
              >{{ reward.requiredPoints }} pts</span
            >
          </div>
        </div>
      </div>

      <ng-template #noRewards>
        <p class="text-gray-500 text-sm italic">
          No hay premios disponibles aún.
        </p>
      </ng-template>
    </div>
  </div>
</div>
