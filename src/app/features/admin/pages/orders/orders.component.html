<div class="p-6">
  <h2 class="text-2xl font-bold mb-4">📦 Gestión de Órdenes</h2>

  @if (orders.length === 0) {
  <div
    class="flex flex-col items-center justify-center bg-gray-50 border border-dashed border-gray-300 rounded-lg p-10 text-center shadow-sm"
  >
    <i class="pi pi-inbox text-6xl text-gray-400 mb-4"></i>
    <h3 class="text-lg font-semibold text-gray-700">
      No tienes órdenes registradas
    </h3>
    <p class="text-gray-500 mt-1 mb-4">
      Cuando recibas nuevas órdenes aparecerán aquí.
    </p>
    <button
      pButton
      type="button"
      icon="pi pi-refresh"
      label="Actualizar"
      class="p-button-outlined p-button-sm"
      (click)="loadOrders()"
    ></button>
  </div>
  } @else {
  <p-table [value]="orders" class="shadow-lg rounded-lg overflow-hidden">
    <ng-template pTemplate="header">
      <tr>
        <th class="text-left"># Orden</th>
        <th class="text-left">Cliente</th>
        <th class="text-left">Dirección</th>
        <th class="text-left">Fecha</th>
        <th class="text-right">Total</th>
        <th class="text-center">Estado</th>
        <th class="text-center">Acciones</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body">
      @for (order of orders; track order.id) {
      <tr>
        <td>{{ order.id }}</td>
        <td>{{ order.customerName }}</td>
        <td>{{ order.addressDescription }}</td>
        <td>{{ order.date | date : "short" }}</td>
        <td class="text-right">S/. {{ order.total | number : "1.2-2" }}</td>
        <td class="text-center">
          <span
            class="px-3 py-1 rounded-full text-xs font-semibold"
            [ngClass]="getStatusClass(order.statusName)"
          >
            {{ order.statusName }}
          </span>
        </td>
        <td class="text-center space-x-2">
          <button
            pButton
            type="button"
            icon="pi pi-search"
            class="p-button-sm p-button-rounded p-button-info"
            (click)="viewOrder(order)"
          ></button>

          <button
            pButton
            type="button"
            icon="pi pi-times"
            class="p-button-sm p-button-rounded p-button-danger"
            [disabled]="
              order.statusName === 'DELIVERED' ||
              order.statusName === 'CANCELLED'
            "
            (click)="cancelOrder(order)"
          ></button>
        </td>
      </tr>
      }
    </ng-template>
  </p-table>
  }

  <div class="mt-10">
    <h3 class="text-xl font-semibold mb-6">🍽️ Vista de Mesas</h3>

    <div
      class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-6"
    >
      <div
        *ngFor="let table of tables"
        class="p-6 rounded-xl shadow-md flex flex-col items-center justify-center cursor-pointer transition hover:scale-105 hover:shadow-lg"
        [ngClass]="{
          'bg-green-100 border border-green-400': table.status === 'FREE',
          'bg-yellow-100 border border-yellow-400': table.status === 'OCCUPIED',
          'bg-red-100 border border-red-400': table.status === 'RESERVED'
        }"
        (click)="selectTable(table)"
      >
        <i class="pi pi-table text-3xl mb-2"></i>
        <span class="font-semibold">Mesa {{ table.number }}</span>
        <small class="text-gray-700">{{ table.status }}</small>
        <div *ngIf="table.orderId" class="mt-2 text-xs text-gray-600">
          Orden #{{ table.orderId }}
        </div>
      </div>
    </div>
  </div>
</div>
