<div class="p-6 max-w-5xl mx-auto space-y-6">

  <!-- Botones de acción -->
  <div class="flex justify-between items-center mb-6 border-b border-gray-200 pb-4">
    <p-button
      variant="outlined"
      severity="secondary"
      icon="pi pi-arrow-left"
      (click)="goBack()"
      label="Volver"
      [raised]="true"
    />
    <p-button
      *ngIf="user"
      label="Editar"
      icon="pi pi-pencil"
      [raised]="true"
      severity="help"
      (click)="editUser(user.id)"
    />
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="text-gray-500 italic text-center py-12">
    Cargando usuario...
  </div>

  <!-- Error -->
  <div
    *ngIf="!loading && errorMessage"
    class="text-red-500 font-semibold text-center py-12"
  >
    {{ errorMessage }}
  </div>

  <!-- Usuario -->
  <div *ngIf="!loading && user" class="grid gap-8 md:grid-cols-3 items-start">

    <!-- Avatar + Estado -->
    <div
      class="flex flex-col items-center md:col-span-1 bg-white shadow-lg rounded-2xl p-6 hover:shadow-2xl transition-all duration-300 border border-transparent hover:border-indigo-300"
    >
      <p-avatar
        [image]="user.profileImageUrl || '/default-avatar.jpg'"
        size="xlarge"
        shape="circle"
        class="ring-4 ring-indigo-200 mb-4 transition-transform duration-300 hover:scale-105"
      ></p-avatar>

      <h2 class="text-2xl font-bold text-gray-800 flex items-center gap-2">
        {{ user.fullName }}
        <span
          class="w-3 h-3 rounded-full"
          [ngClass]="user.enabled ? 'bg-green-500' : 'bg-red-500'"
        ></span>
      </h2>
      <p class="text-gray-500">{{ user.username }}</p>

      <span
        class="mt-3 px-4 py-1 rounded-full text-sm font-semibold shadow"
        [ngClass]="user.enabled ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'"
      >
        {{ user.enabled ? "Activo" : "Inactivo" }}
      </span>

      <span
        class="mt-2 px-4 py-1 rounded-full text-sm font-semibold bg-blue-100 text-blue-800 shadow"
      >
        {{ user.provider }}
      </span>
    </div>

    <!-- Información básica + roles + seguridad -->
    <div class="md:col-span-2 space-y-6">

      <!-- Contacto -->
      <div
        class="bg-white shadow-lg rounded-2xl p-6 hover:shadow-2xl transition-all duration-300 border border-transparent hover:border-indigo-300"
      >
        <h3 class="text-lg font-semibold text-gray-700 flex items-center gap-2">
          <i class="pi pi-envelope text-indigo-500"></i>
          Información de contacto
        </h3>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-2">
          <div class="flex flex-col">
            <span class="text-gray-500 text-sm">Correo</span>
            <span class="text-gray-800 font-medium">{{ user.email }}</span>
          </div>
          <div class="flex flex-col">
            <span class="text-gray-500 text-sm">Teléfono</span>
            <span class="text-gray-800 font-medium">{{ user.phone || 'No registrado' }}</span>
          </div>
        </div>
      </div>

      <!-- Roles -->
      <div
        class="bg-white shadow-lg rounded-2xl p-6 hover:shadow-2xl transition-all duration-300 border border-transparent hover:border-indigo-300"
      >
        <h3 class="text-lg font-semibold text-gray-700 flex items-center gap-2">
          <i class="pi pi-users text-indigo-500"></i>
          Roles
        </h3>
        <div class="flex flex-wrap gap-2 mt-2">
          <span
            *ngFor="let role of user.roles"
            class="bg-indigo-100 text-indigo-800 px-3 py-1 rounded-full text-sm font-medium"
          >
            {{ role | roleLabel }}
          </span>
        </div>
      </div>

      <!-- Seguridad -->
      <div
        class="bg-white shadow-lg rounded-2xl p-6 hover:shadow-2xl transition-all duration-300 border border-transparent hover:border-indigo-300"
      >
        <h3 class="text-lg font-semibold text-gray-700 flex items-center gap-2">
          <i class="pi pi-lock text-indigo-500"></i>
          Seguridad
        </h3>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-2">
          <div class="flex flex-col">
            <span class="text-gray-500 text-sm">Cambio de username</span>
            <span class="text-gray-800 font-medium">
              {{ user.usernameNextChange ? (user.usernameNextChange | date:'mediumDate') : 'Disponible' }}
            </span>
          </div>
          <div class="flex flex-col">
            <span class="text-gray-500 text-sm">Cambio de email</span>
            <span class="text-gray-800 font-medium">
              {{ user.emailNextChange ? (user.emailNextChange | date:'mediumDate') : 'Disponible' }}
            </span>
          </div>
          <div class="flex flex-col">
            <span class="text-gray-500 text-sm">Contraseña</span>
            <span class="text-gray-800 font-medium">{{ user.hasPassword ? 'Establecida' : 'No establecida' }}</span>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>
