<p-dialog
  header="Calificar {{ resourceName }}"
  [(visible)]="display"
  (onHide)="closeModal()"
  [modal]="true"
  [draggable]="false"
  [dismissableMask]="true"
  [style]="{ width: '90%', 'max-width': '520px' }"
  styleClass="rounded-2xl shadow-2xl overflow-hidden"
>
  <form [formGroup]="reviewForm" (ngSubmit)="onSubmit()" class="p-2 sm:p-4">
    <!-- Calificación -->
    <div class="text-center mb-6">
      <h3 class="text-2xl font-semibold text-gray-800 mb-2">Tu calificación</h3>
      <p class="text-sm text-gray-500 mb-3">
        Valora tu experiencia con {{ resourceName }}
      </p>

      <div class="flex justify-center mb-2">
        <p-rating
          formControlName="rating"
          [stars]="5"
          [readonly]="false"
          [iconOnClass]="'pi pi-star-fill text-yellow-400 text-3xl'"
          [iconOffClass]="'pi pi-star text-gray-300 text-3xl'"
          
        ></p-rating>
      </div>

      <small
        *ngIf="
          reviewForm.controls['rating'].invalid &&
          reviewForm.controls['rating'].touched
        "
        class="text-red-500 block mt-1"
        >La calificación es obligatoria.</small
      >
    </div>

    <!-- Comentario -->
    <div class="mb-5">
      <label
        for="comment"
        class="font-semibold text-gray-700 block mb-2 text-sm"
        >Tu comentario (opcional):</label
      >
      <textarea
        pTextarea
        id="comment"
        formControlName="comment"
        rows="4"
        class="w-full border border-gray-300 rounded-xl p-3 focus:ring-2 focus:ring-cyan-500 focus:outline-none transition-all"
        placeholder="Cuéntanos qué te pareció..."
      ></textarea>
    </div>

    <!-- Error -->
    <div
      *ngIf="errorMessage"
      class="text-center bg-red-100 text-red-700 py-2 rounded-lg mb-4 text-sm"
    >
      {{ errorMessage }}
    </div>

    <!-- Botones -->
    <div class="flex justify-end gap-3 mt-6">
      <p-button
        label="Cancelar"
        styleClass="p-button-text p-button-rounded"
        (onClick)="closeModal()"
        [disabled]="isLoading"
      ></p-button>
      <p-button
        label="Enviar Reseña"
        type="submit"
        [disabled]="reviewForm.invalid || isLoading"
        [loading]="isLoading"
        icon="pi pi-send"
        styleClass="p-button-rounded p-button-primary"
      ></p-button>
    </div>
  </form>
</p-dialog>
