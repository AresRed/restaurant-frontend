<div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-7xl mx-auto mt-40">
  <!-- Columna izquierda -->
  <div class="md:col-span-2 bg-white p-6 rounded-2xl shadow-lg space-y-6">
    <h2 class="text-2xl font-bold text-gray-800 text-center">
      Opciones de Compra
    </h2>

    <p-stepper [value]="activeStepIndex + 1" [linear]="true" styleClass="w-full">
      <p-step-list>
        <p-step [value]="1" icon="pi pi-truck">Tipo de Entrega</p-step>
        <p-step [value]="2" icon="pi pi-map-marker"
          >Dirección / Sucursal</p-step
        >
        <p-step [value]="3" icon="pi pi-credit-card">Método de Pago</p-step>
      </p-step-list>
    </p-stepper>

    <ng-container [ngSwitch]="activeStepIndex">
      <app-checkout-step-delivery-type
        *ngSwitchCase="0"
        [orderTypes]="orderTypes"
        [selectedOrderType]="selectedOrderType"
        (selectType)="selectedOrderType = $event"
        (next)="goToStep(1)"
      >
      </app-checkout-step-delivery-type>

      <app-checkout-step-address
         *ngSwitchCase="1"
        [selectedOrderTypeCode]="selectedOrderType?.code || ''"
        (back)="goToStep(0)"
        (next)="handleStep2Data($event)"
      >
      </app-checkout-step-address>

      <app-checkout-step-payment
        *ngSwitchCase="2"
        [total]="total"
        [mercadoPagoPublicKey]="mercadoPagoPublicKey"
        (back)="goToStep(1)"
        (token)="handleBrickToken($event)"
      >
      </app-checkout-step-payment>
    </ng-container>
  </div>

  <div class="bg-white p-6 rounded-2xl shadow-lg sticky top-6 h-fit space-y-4">
    <h2 class="text-2xl font-bold text-gray-800">Resumen del Pedido</h2>

    <div
      *ngFor="let item of items"
      class="flex justify-between py-2 border-b border-gray-200 text-gray-700"
    >
      <div>{{ item.name }} x{{ item.quantity }}</div>
      <div>S/{{ item.price * item.quantity | number : "1.2-2" }}</div>
    </div>

    <div class="flex justify-between text-gray-600">
      <span>Subtotal</span>
      <span>S/{{ total / 1.18 | number : "1.2-2" }}</span>
    </div>
    <div class="flex justify-between text-gray-600">
      <span>IGV (18%)</span>
      <span>S/{{ (total * 0.18) / 1.18 | number : "1.2-2" }}</span>
    </div>
    <div
      class="flex justify-between font-bold text-gray-900 text-lg border-t border-gray-300 pt-3"
    >
      <span>Total</span>
      <span>S/{{ total | number : "1.2-2" }}</span>
    </div>
  </div>
</div>
